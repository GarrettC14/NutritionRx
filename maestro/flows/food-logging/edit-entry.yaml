appId: com.nutritionrx.app
name: Edit Food Log Entry
tags:
  - food-logging
  - edit
---
- launchApp:
    clearState: true
- runFlow: ../../utils/complete-onboarding.yaml

# Navigate to add-food via Food tab
- tapOn:
    id: "tab-bar-food"

- extendedWaitUntil:
    visible:
      id: "add-food-screen"
    timeout: 5000

# Search for a food to log
- tapOn:
    id: "add-food-search-input"
- inputText: "apple"

- extendedWaitUntil:
    visible:
      id: "add-food-search-result-item-.*"
    timeout: 10000

- tapOn:
    id: "add-food-search-result-item-.*"
    index: 0

- extendedWaitUntil:
    visible:
      id: "log-food-screen"
    timeout: 5000

# Log the food (defaults to Snack meal type)
- tapOn:
    id: "log-food-add-button"

- waitForAnimationToEnd

# Navigate home via tab bar
- tapOn:
    id: "tab-bar-home"

- extendedWaitUntil:
    visible:
      id: "home-screen"
    timeout: 5000

# Wait for data to load (skeleton dismisses and date label appears)
- extendedWaitUntil:
    visible:
      id: "home-date-label"
    timeout: 8000

# Swipe to meal sections (DraggableFlatList workaround)
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500

# Expand the Snack section (default meal type)
- tapOn:
    id: "meal-snack-section"

- waitForAnimationToEnd

# Now tap on the entry to edit it
- tapOn:
    id: "meal-entry-item-.*"
    index: 0

- extendedWaitUntil:
    visible:
      id: "log-entry-screen"
    timeout: 5000

# Verify edit elements
- assertVisible:
    id: "log-entry-close-button"
- assertVisible:
    id: "log-entry-amount-input"
- assertVisible:
    id: "log-entry-save-button"
- assertVisible:
    id: "log-entry-delete-button"

# Verify meal change options
- assertVisible:
    id: "log-entry-meal-breakfast"
- assertVisible:
    id: "log-entry-meal-lunch"
- assertVisible:
    id: "log-entry-meal-dinner"
- assertVisible:
    id: "log-entry-meal-snack"

# Change amount
- tapOn:
    id: "log-entry-amount-input"
- eraseText
- inputText: "1.5"

- hideKeyboard

# Change meal to lunch
- tapOn:
    id: "log-entry-meal-lunch"

# Save changes
- tapOn:
    id: "log-entry-save-button"

- extendedWaitUntil:
    visible:
      id: "home-screen"
    timeout: 5000
