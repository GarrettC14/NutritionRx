appId: com.nutritionrx.app
name: Quick Add Flow
tags:
  - food-logging
  - quick-add
---
- launchApp:
    clearState: true
- runFlow: ../../utils/complete-onboarding.yaml

- assertVisible:
    id: "home-screen"

# Swipe down to meal sections (DraggableFlatList doesn't support scrollUntilVisible)
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500

# Add food to lunch via meal section button
- tapOn:
    id: "meal-add-food-button-lunch"

- extendedWaitUntil:
    visible:
      id: "add-food-screen"
    timeout: 3000

# Navigate to Quick Add via bottom button
- tapOn:
    text: "Quick Add"

- extendedWaitUntil:
    visible:
      id: "quick-add-screen"
    timeout: 3000

# Verify elements
- assertVisible:
    id: "quick-add-back-button"
- assertVisible:
    id: "quick-add-calories-input"
- assertVisible:
    id: "quick-add-protein-input"
- assertVisible:
    id: "quick-add-carbs-input"
- assertVisible:
    id: "quick-add-fat-input"
- assertVisible:
    id: "quick-add-description-input"
- assertVisible:
    id: "quick-add-add-button"

# Verify meal options
- assertVisible:
    id: "quick-add-meal-breakfast"
- assertVisible:
    id: "quick-add-meal-lunch"
- assertVisible:
    id: "quick-add-meal-dinner"
- assertVisible:
    id: "quick-add-meal-snack"

# Lunch should be pre-selected since we came from lunch section
- tapOn:
    id: "quick-add-meal-lunch"

# Enter macros
- tapOn:
    id: "quick-add-calories-input"
- inputText: "450"

- tapOn:
    id: "quick-add-protein-input"
- inputText: "30"

- tapOn:
    id: "quick-add-carbs-input"
- inputText: "40"

- tapOn:
    id: "quick-add-fat-input"
- inputText: "15"

- tapOn:
    id: "quick-add-description-input"
- inputText: "Leftover pasta"

- hideKeyboard

- tapOn:
    id: "quick-add-add-button"

# Wait for dismiss animation (returns to add-food screen)
- waitForAnimationToEnd

# Navigate home via tab bar
- tapOn:
    id: "tab-bar-home"

- extendedWaitUntil:
    visible:
      id: "home-screen"
    timeout: 3000

# Verify the quick-add entry appears in Lunch section
- extendedWaitUntil:
    visible:
      id: "home-date-label"
    timeout: 8000

- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500

# Expand Lunch section
- tapOn:
    id: "meal-lunch-section"

- waitForAnimationToEnd

# Verify the logged entry is visible
- assertVisible:
    id: "meal-entry-item-.*"
