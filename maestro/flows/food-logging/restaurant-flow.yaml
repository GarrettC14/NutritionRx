appId: com.nutritionrx.app
name: Restaurant Food Logging
tags:
  - food-logging
  - restaurant
---
- launchApp:
    clearState: true
- runFlow: ../../utils/complete-onboarding.yaml

# Seed data to ensure restaurants are loaded
- runFlow: ../../utils/seed-data.yaml

# Already on home screen after seed-data

# Wait for skeleton to dismiss (home-date-label only renders after isReady)
- extendedWaitUntil:
    visible:
      id: "home-date-label"
    timeout: 8000

# Swipe down to meal sections (DraggableFlatList doesn't support scrollUntilVisible)
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500

- tapOn:
    id: "meal-add-food-button-lunch"

- extendedWaitUntil:
    visible:
      id: "add-food-screen"
    timeout: 5000

# Switch to Restaurants tab to access Browse button
- tapOn:
    id: "add-food-tab-restaurants"

- waitForAnimationToEnd

- tapOn:
    id: "add-food-browse-restaurants-button"

# Restaurant screen has its own loading skeleton - screen testID appears immediately
- extendedWaitUntil:
    visible:
      id: "restaurant-list-screen"
    timeout: 15000

# Wait for content to load (search input only appears after skeleton dismisses)
- extendedWaitUntil:
    visible:
      id: "restaurant-search-input"
    timeout: 15000
- assertVisible:
    id: "restaurant-back-button"

# Search for a restaurant
- tapOn:
    id: "restaurant-search-input"
- inputText: "McDonald"

- waitForAnimationToEnd

# Tap on a restaurant result
- tapOn:
    id: "restaurant-item-.*"
    index: 0

# Restaurant menu screen
- extendedWaitUntil:
    visible:
      id: "restaurant-menu-screen"
    timeout: 5000

- assertVisible:
    id: "restaurant-menu-back-button"
- assertVisible:
    id: "restaurant-menu-search-input"
- assertVisible:
    id: "restaurant-category-all"

# Tap on a menu item
- tapOn:
    id: "restaurant-menu-item-.*"
    index: 0

# Restaurant food detail
- extendedWaitUntil:
    visible:
      id: "restaurant-food-screen"
    timeout: 5000

- assertVisible:
    id: "restaurant-food-back-button"
- assertVisible:
    id: "restaurant-food-amount-input"
- assertVisible:
    id: "restaurant-food-add-button"

# Verify meal options
- assertVisible:
    id: "restaurant-food-meal-lunch"

# Add to log
- tapOn:
    id: "restaurant-food-add-button"

# Wait for navigation (may return to add-food, not home)
- waitForAnimationToEnd

# Navigate home via tab bar
- tapOn:
    id: "tab-bar-home"

- extendedWaitUntil:
    visible:
      id: "home-screen"
    timeout: 5000
