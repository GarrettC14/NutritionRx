appId: com.nutritionrx.app
name: Delete Food Log Entry
tags:
  - food-logging
  - delete
---
- launchApp:
    clearState: true
- runFlow: ../../utils/complete-onboarding.yaml

# Navigate to add-food via Food tab to create an entry to delete
- tapOn:
    id: "tab-bar-food"

- extendedWaitUntil:
    visible:
      id: "add-food-screen"
    timeout: 5000

# Quick Add to create a simple entry
- tapOn:
    id: "add-food-quick-add-button"

- extendedWaitUntil:
    visible:
      id: "quick-add-screen"
    timeout: 3000

- tapOn:
    id: "quick-add-calories-input"
- inputText: "100"

- hideKeyboard

- tapOn:
    id: "quick-add-add-button"

# Wait for dismiss animation (returns to add-food screen)
- waitForAnimationToEnd

# Navigate home via tab bar
- tapOn:
    id: "tab-bar-home"

- extendedWaitUntil:
    visible:
      id: "home-screen"
    timeout: 5000

# Wait for data to load (skeleton dismisses and date label appears)
- extendedWaitUntil:
    visible:
      id: "home-date-label"
    timeout: 8000

# Swipe to meal sections (DraggableFlatList workaround)
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500

# Expand the Snack section (Quick Add defaults to Snack)
- tapOn:
    id: "meal-snack-section"

- waitForAnimationToEnd

# Open the entry (use regex to match any meal-entry-item-{id})
- tapOn:
    id: "meal-entry-item-.*"
    index: 0

- extendedWaitUntil:
    visible:
      id: "log-entry-screen"
    timeout: 5000

# Delete it
- tapOn:
    id: "log-entry-delete-button"

# Confirm deletion dialog appeared
- assertVisible:
    id: "ui-confirm-dialog"

- tapOn:
    id: "ui-confirm-dialog-confirm"

- waitForAnimationToEnd

- extendedWaitUntil:
    visible:
      id: "home-screen"
    timeout: 5000

# Verify the entry is gone after deletion
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500

- tapOn:
    id: "meal-snack-section"

- waitForAnimationToEnd

- assertNotVisible:
    id: "meal-entry-item-.*"
