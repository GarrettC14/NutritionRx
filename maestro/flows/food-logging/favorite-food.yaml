appId: com.nutritionrx.app
name: Favorite Food Flow
tags:
  - food-logging
  - favorites
---
- launchApp:
    clearState: true
- runFlow: ../../utils/complete-onboarding.yaml

- runFlow: ../../utils/seed-data.yaml

# Navigate to add-food via Food tab
- tapOn:
    id: "tab-bar-food"

- extendedWaitUntil:
    visible:
      id: "add-food-screen"
    timeout: 5000

# Search for a food
- tapOn:
    id: "add-food-search-input"
- inputText: "apple"

# Wait for search debounce + API response + render
- extendedWaitUntil:
    visible:
      id: "add-food-search-result-item-.*"
    timeout: 10000

# Select a result
- tapOn:
    id: "add-food-search-result-item-.*"
    index: 0

- extendedWaitUntil:
    visible:
      id: "log-food-screen"
    timeout: 5000

# Favorite the food
- tapOn:
    id: "log-food-favorite-button"

- waitForAnimationToEnd

# Add to log
- tapOn:
    id: "log-food-add-button"

# Wait for navigation (dismiss returns to add-food)
- waitForAnimationToEnd

# Navigate home then back to add food to check favorites
- tapOn:
    id: "tab-bar-home"

- extendedWaitUntil:
    visible:
      id: "home-screen"
    timeout: 5000

# Go back to add food via Food tab and check favorites
- tapOn:
    id: "tab-bar-food"

- extendedWaitUntil:
    visible:
      id: "add-food-screen"
    timeout: 5000

# Verify favorites section exists
- assertVisible:
    id: "add-food-favorites-section"
