appId: com.nutritionrx.app
name: Full Onboarding Flow
tags:
  - onboarding
  - complete
---
- launchApp:
    clearState: true

- extendedWaitUntil:
    visible:
      id: "legal-screen"
    timeout: 30000

# === Legal ===
- assertVisible:
    id: "legal-screen"

# Swipe to scroll to bottom (triggers onScroll events for hasScrolledToBottom)
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500
- swipe:
    direction: UP
    duration: 500

# Wait for scroll-to-bottom detection
- extendedWaitUntil:
    visible:
      id: "legal-scroll-complete"
    timeout: 3000

- tapOn:
    id: "legal-checkbox"

- tapOn:
    id: "legal-proceed-button"

# === Welcome ===
- extendedWaitUntil:
    visible:
      id: "onboarding-welcome-screen"
    timeout: 5000

- tapOn:
    id: "onboarding-begin-button"

# === Goal Selection ===
- assertVisible:
    id: "onboarding-goal-screen"
- assertVisible:
    id: "onboarding-goal-back-button"

# Verify all goal options
- assertVisible:
    id: "onboarding-goal-option-lose"
- assertVisible:
    id: "onboarding-goal-option-maintain"
- assertVisible:
    id: "onboarding-goal-option-build"
- assertVisible:
    id: "onboarding-goal-option-track"

# Select "Lose weight"
- tapOn:
    id: "onboarding-goal-option-lose"

- tapOn:
    id: "onboarding-goal-continue-button"

# === Preferences ===
- assertVisible:
    id: "onboarding-preferences-screen"
- assertVisible:
    id: "onboarding-preferences-back-button"

# Verify unit options
- assertVisible:
    id: "onboarding-energy-calories"
- assertVisible:
    id: "onboarding-energy-kilojoules"
- assertVisible:
    id: "onboarding-weight-lbs"
- assertVisible:
    id: "onboarding-weight-kg"

# Select preferences
- tapOn:
    id: "onboarding-energy-calories"
- tapOn:
    id: "onboarding-weight-lbs"

- tapOn:
    id: "onboarding-preferences-continue-button"

# === Ready Screen ===
- assertVisible:
    id: "onboarding-ready-screen"
- assertVisible:
    id: "onboarding-ready-back-button"

# Verify CTA options
- assertVisible:
    id: "onboarding-ready-scan-barcode"
- assertVisible:
    id: "onboarding-ready-search-food"
- assertVisible:
    id: "onboarding-ready-explore-app"

# Choose to explore app
- tapOn:
    id: "onboarding-ready-explore-app"

# === Home Screen ===
- extendedWaitUntil:
    visible:
      id: "home-screen"
    timeout: 5000

# Wait for skeleton to dismiss (home-date-label only renders after isReady)
- extendedWaitUntil:
    visible:
      id: "home-date-label"
    timeout: 8000

# Verify a default widget is visible (nutrition_overview is position 0)
- extendedWaitUntil:
    visible:
      id: "widget-nutrition-overview"
    timeout: 5000
