appId: com.nutritionrx.app
name: Profile Settings
tags:
  - settings
  - profile
---
- launchApp:
    clearState: true
- runFlow: ../../utils/complete-onboarding.yaml

- tapOn:
    id: "tab-bar-settings"

- extendedWaitUntil:
    visible:
      id: "settings-screen"
    timeout: 5000

- scrollUntilVisible:
    element:
      id: "settings-profile-row"
    direction: DOWN
    timeout: 5000

- tapOn:
    id: "settings-profile-row"

- extendedWaitUntil:
    visible:
      id: "settings-profile-screen"
    timeout: 8000

- waitForAnimationToEnd

# Verify view mode elements (header renders separately from content)
- extendedWaitUntil:
    visible:
      id: "settings-profile-edit-button"
    timeout: 5000

# Enable editing (sex options only visible in edit mode)
- tapOn:
    id: "settings-profile-edit-button"

- waitForAnimationToEnd

# Now verify edit mode elements
- assertVisible:
    id: "settings-profile-sex-male"
- assertVisible:
    id: "settings-profile-sex-female"

# Change sex
- tapOn:
    id: "settings-profile-sex-female"

# Adjust height
- tapOn:
    id: "settings-profile-height-plus"
- tapOn:
    id: "settings-profile-height-plus"

# Save
- tapOn:
    id: "settings-profile-save-button"

- waitForAnimationToEnd

# Dismiss the success alert dialog
- tapOn:
    text: "OK"
    optional: true

- waitForAnimationToEnd

# Navigate back (use system back on Android as header testIDs may not be accessible)
- back

- extendedWaitUntil:
    visible:
      id: "settings-screen"
    timeout: 5000
