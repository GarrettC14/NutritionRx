# Dashboard Widget Picker E2E Tests
# Test adding and managing widgets
#
# Usage: maestro test .maestro/dashboard/widget-picker.yaml

appId: com.nutritionrx.app

---
# Widget picker flow test
- launchApp:
    clearState: false

- waitForAnimationToEnd

# Navigate to dashboard
- tapOn:
    id: "home-tab"
    optional: true

- waitForAnimationToEnd

# Enter edit mode
- tapOn:
    id: "edit-dashboard-button"
    optional: true

- tapOn:
    text: "Edit"
    optional: true

- waitForAnimationToEnd

# Tap add widget button
- tapOn:
    id: "add-widget-button"
    optional: true

- tapOn:
    text: "Add Widget"
    optional: true

- waitForAnimationToEnd

# Verify widget picker modal appears
- assertVisible:
    text: "Add Widget"

# Verify category filters
- assertVisible:
    text: "All"

- assertVisible:
    text: "Nutrition"

- assertVisible:
    text: "Meals"

- assertVisible:
    text: "Progress"

# Verify some available widgets
- assertVisible:
    text: "Calorie Ring"

- assertVisible:
    text: "Macro Bars"

- assertVisible:
    text: "Water Tracker"

# Test category filter
- tapOn:
    text: "Progress"

- waitForAnimationToEnd

# Progress widgets should be visible
- assertVisible:
    text: "Weight Trend"

- assertVisible:
    text: "Streak Badge"

- assertVisible:
    text: "Weekly Average"

# Close the picker
- tapOn:
    id: "close-picker"
    optional: true

# Alternative close method
- back:
    optional: true

- waitForAnimationToEnd

# Exit edit mode
- tapOn:
    text: "Done"
    optional: true
