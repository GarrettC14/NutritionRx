# HealthKit Integration E2E Test Suite
# Run all HealthKit-related tests
#
# Usage: maestro test .maestro/healthkit/healthkit-flow.yaml

appId: com.nutritionrx.app

---
# Full HealthKit integration flow test
- launchApp:
    clearState: true

- waitForAnimationToEnd

# Skip onboarding if present (tap Maybe Later or Skip)
- tapOn:
    text: "Skip"
    optional: true

- waitForAnimationToEnd

# Navigate to Settings
- tapOn:
    id: "settings-tab"

- waitForAnimationToEnd

# Scroll to DATA section
- scroll:
    direction: DOWN

# Verify Apple Health option is visible on iOS
- assertVisible:
    text: "Apple Health"

- assertVisible:
    text: "Sync nutrition, weight, and water"

# Tap to open Apple Health settings
- tapOn:
    text: "Apple Health"

- waitForAnimationToEnd

# Verify screen title
- assertVisible:
    text: "Apple Health"

# Verify subtitle describing the feature
- assertVisible:
    text: "Keep your health data in sync"

# If not connected, verify Connect button and status
- assertVisible:
    text: "Not connected"
    optional: true

- assertVisible:
    text: "Connect to Apple Health"
    optional: true

# If connected, verify settings are visible
- assertVisible:
    text: "What to sync"
    optional: true

# Verify privacy message at bottom
- scroll:
    direction: DOWN

- assertVisible:
    text: "Your data is stored securely on your device"

- assertVisible:
    text: "We never see or store your health information"

# Verify help section
- assertVisible:
    text: "Need help?"

- assertVisible:
    text: "Settings > Health > Data Access"
    optional: true

# Navigate back to settings
- back

- waitForAnimationToEnd

# Verify we're back on main settings
- assertVisible:
    text: "Settings"
